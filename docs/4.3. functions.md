[← Back to index](1.%20index.md) | [← Back to utilities](4.%20utilities.md)

# Functions & Converters

Shared utility functions used across the framework.

## converters module <a id="converters"></a>

**Source:** `data_collector/utilities/functions/converters.py`

### object_to_dict() <a id="object-to-dict"></a>

Best-effort conversion of any Python object to a plain `dict` suitable for deterministic hashing.

```python
from data_collector.utilities.functions.converters import object_to_dict
```

**Conversion strategy (in order):**

| Input Type | Strategy |
|-----------|----------|
| `Mapping` or `dataclass` | `.items()` → filter out callables and `_` prefixed keys |
| Object with `__dict__` | `obj.__dict__` → filter out callables and `_` prefixed keys |
| Object with `__slots__` | Iterate slots → filter out `_` prefixed, skip callables |
| Primitives (str, int, list, etc.) | Return as-is |

**Example:**
```python
from data_collector.utilities.functions.converters import object_to_dict

class MyObj:
    def __init__(self):
        self.name = "John"
        self.age = 30
        self._internal = "hidden"

result = object_to_dict(MyObj())
# {'name': 'John', 'age': 30}  — _internal is excluded
```

### Time Converters

| Function | Signature | Description |
|----------|-----------|-------------|
| `ns_to_sec(nanoseconds)` | `float → float` | Nanoseconds to seconds |
| `sec_to_min(seconds)` | `float → int` | Seconds to minutes (integer) |
| `min_to_h(minutes)` | `int → int` | Minutes to hours (integer) |
| `sec_to_h(seconds)` | `float → int` | Seconds to hours (integer) |

```python
from data_collector.utilities.functions.converters import ns_to_sec, sec_to_min

seconds = ns_to_sec(1500000)     # 1.5
minutes = sec_to_min(3600)       # 60
```

### to_none() <a id="to-none"></a>

Normalizes various "empty" values to Python `None`.

```python
from data_collector.utilities.functions.converters import to_none

to_none(None)    # None
to_none("NaN")   # None
to_none("NaT")   # None
to_none("none")  # None
to_none("hello") # "hello" (unchanged)
```

## math module <a id="math"></a>

**Source:** `data_collector/utilities/functions/math.py`

Runtime duration calculations between two datetimes. Used by the `Runtime` table population.

| Function | Returns | Description |
|----------|---------|-------------|
| `get_totals(start, end)` | `int` | Total seconds between two datetimes |
| `get_totalm(start, end)` | `int` | Total minutes between two datetimes |
| `get_totalh(start, end)` | `int` | Total hours between two datetimes |

```python
from datetime import datetime
from data_collector.utilities.functions.math import get_totals, get_totalm, get_totalh

start = datetime(2025, 1, 1, 10, 0, 0)
end = datetime(2025, 1, 1, 12, 30, 0)

get_totals(start, end)  # 9000
get_totalm(start, end)  # 150
get_totalh(start, end)  # 2
```

## runtime module <a id="runtime"></a>

**Source:** `data_collector/utilities/functions/runtime.py`

> For `make_hash()`, `bulk_hash()`, and `obj_diff()` see [4.2. hashing.md](4.2.%20hashing.md).

### is_module_available() <a id="is-module-available"></a>

Checks if a Python module is installed and importable at runtime.

```python
from data_collector.utilities.functions.runtime import is_module_available

is_module_available('pyodbc')    # True if installed
is_module_available('psycopg2')  # True if installed
is_module_available('nonexist')  # False
```

Used internally by `loaders.py` to verify database driver availability before attempting connections.

### list_enum_values() <a id="list-enum-values"></a>

Returns the values of all members of an Enum class.

```python
from data_collector.utilities.functions.runtime import list_enum_values
from data_collector.settings.main import DatabaseType

list_enum_values(DatabaseType)
# ['Postgres', 'MsSQL']
```
